{
    "collab_server" : "",
    "contents" : "---\ntitle: \"R Notebook\"\noutput: html_notebook\n---\n\nThis is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. \n\nTry executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Ctrl+Shift+Enter*. \n\n```{r}\nsummary(USArrests)\nstr(USArrests)\n\nstates <- row.names(USArrests)\nstates; \nwriteLines('Names of the data frame \\n  USArrests')\nnames(USArrests )\nwriteLines('Mean \\n  USArrests'); apply(USArrests , 2, mean)\nwriteLines('Variance \\n  USArrests'); apply(USArrests , 2, var)\n\n```\n```{r}\npr.out <- prcomp(USArrests , scale =TRUE)\nnames(pr.out )\n\nwriteLines('\\n Returns mean'); pr.out$center\nwriteLines('\\n Returns standard deviation '); pr.out$scale\nwriteLines('\\n')\n\n# The rotation matrix provides the principal component loadings; each column of pr.out$rotation \n# contains the corresponding principal component loading vector\nwriteLines('\\n Rotation Matrix \\n These coordinates are the principal component scores.')\npr.out$rotation\nwriteLines('\\n')\nsummary(pr.out)\n\nwriteLines('\\n x dimension')\ndim(pr.out$x)\n\n```\n\n```{r}\n# Plot the first two principal components as follows\n# The scale=0 argument to biplot() ensures that the arrows are scaled to biplot() represent the loadings\nbiplot(pr.out , scale =0, cex = 0.7)\n\n#the principal components are only unique up to a sign change\npr.out$rotation <- -pr.out$rotation\npr.out$x <- -pr.out$x\nbiplot(pr.out , scale = 0, cex = 0.7)\n```\n\n```{r}\npr.var <- pr.out$sdev^2\npve <- pr.var/sum(pr.var )\n\npve\nplot(pve , xlab=\" Principal Component \", \n           ylab=\" Proportion of Variance Explained \",\n           ylim=c(0,1) ,type='b')\n\npr.var\nplot(cumsum (pve ), xlab=\" Principal Component \", \n           ylab =\"Cumulative Proportion of Variance Explained \", \n           ylim=c(0,1) , type='b')\n\nlibrary(tidyverse)\n\np <- ggplot() + \n  geom_line(mapping = aes(x = 1:4,y = pve), color = \"blue\", size = 1.5)+\n  geom_line(mapping = aes(x = 1:4,y = cumsum (pve )), color = \"red\", size = 1.2)+\n  labs(x = \" Principal Component \", y = \" Proportion vs Cumulative Proportion of Variance Explained\")\n\np+annotate(\"text\", x = c(2.5,2.5), y =c(0.75,0.3), label = c(\"Cumulative Proportion of Variance Explained\", \"Proportion of Variance Explained\"),color = c(\"red\",\"blue\"), size = 3)\n\n```\n\n```{r}\nnames(summary(pr.out))\nis.list(summary(pr.out))\nimportance <- summary(pr.out)$importance\n\nggplot()+\n  geom_line(mapping = aes(x=1:4, y = importance[1,]))+\n  geom_line(mapping = aes(x=1:4, y = importance[2,]), color = \"red\")+\n  geom_line(mapping = aes(x=1:4, y = importance[3,]), color = \"blue\")+\n  labs(x = \" Principal Component \", y = \" Importance\")+\n  annotate(\"text\",x = c(3.5, 3.5, 3.5), \n           y = c(1.25, 0.7, 0.25), \n           label = c(\"Cumulative Proportion of Variance Explained\", \n                     \"Standard deviation\",\n                     \"Proportion of Variance Explained\"),\n          color = c(\"blue\", \"black\", \"red\"),\n          size = 3)                    \n\n\n```\n\n\n\n\n\nAdd a new chunk by clicking the *Insert Chunk* button on the toolbar or by pressing *Ctrl+Alt+I*.\n\nWhen you save the notebook, an HTML file containing the code and output will be saved alongside it (click the *Preview* button or press *Ctrl+Shift+K* to preview the HTML file).\n",
    "created" : 1503577253116.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3175192720",
    "id" : "FA5543A8",
    "lastKnownWriteTime" : 1503577333,
    "last_content_update" : 1503577333406,
    "path" : "~/GitHub/PCA/pca.Rmd",
    "project_path" : "pca.Rmd",
    "properties" : {
        "chunk_output_type" : "inline"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "source_window" : "",
    "type" : "r_markdown"
}